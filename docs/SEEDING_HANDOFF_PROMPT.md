# Handoff Prompt: Seeding Firestore

This document provides a handoff prompt for seeding the Firestore database with the converted legacy data.

## Objective

To seed the Firestore database with the data generated by the conversion scripts.

## Context

The conversion and seeding tools have been audited and normalized. All legacy data has been converted to the new schema and is ready to be seeded into Firestore. The canonical bundle lives at `seeds/Atul-Final-Seeds/gameDataCatalogs.v3.normalized.json`. Individual catalog files (e.g., `CarsCatalog.json`, `SpellsCatalog.json`) are maintained as source files and must be manually synchronized into the normalized bundle when updated.

**Important:** When updating individual catalog files, ensure changes are propagated to `gameDataCatalogs.v3.normalized.json` before seeding, as the seeding process reads exclusively from the normalized bundle.

For a detailed summary of the changes made to the tools and the commands to rerun the entire process, please refer to the [**Audit of Tools Runtime**](./AUDIT_TOOLS_RUNTIME.md) document.

For the complete deployment process, including the seeding commands, please refer to the [**Sandbox Deployment Guide**](./SANDBOX_DEPLOY.md).

## Instructions

To seed the Firestore database, run the following command:

```bash
# Seed all catalogs into the non-suffixed documents listed in FIRESTORE_SCHEMA.md
npm run tools:seed-firestore
```

**Note:** The `npm run tools:normalize-v3` command referenced in older documentation does not currently exist. Individual catalog files must be manually synchronized into `gameDataCatalogs.v3.normalized.json` when updated.

## Legacy Seed Artifacts

Individual catalog JSON files in `seeds/Atul-Final-Seeds/` serve as source files for manual editing. After editing, they must be synchronized into `gameDataCatalogs.v3.normalized.json` before seeding. The seeding script reads exclusively from the normalized bundle.
## Catalog File Structure

The seeding system uses two types of catalog files:

### Source Files (Individual Catalogs)
Located in `seeds/Atul-Final-Seeds/`:
- `CarsCatalog.json`
- `SpellsCatalog.json`
- `ItemsCatalog.json`
- `ItemSkusCatalog.json`
- `CratesCatalog.json`
- `OffersCatalog.json`
- `RanksCatalog.json`
- `BoostersCatalog.json`
- `BotConfig.json`
- `BotNamesConfig.json`
- `XpCurve.json`

These files are human-editable and serve as the source of truth for their respective catalogs.

### Normalized Bundle (Seeding Source)
- `gameDataCatalogs.v3.normalized.json`

This consolidated file contains all catalogs in Firestore's expected format. **This is what `tools/seedFirestore.ts` reads from.**

### Update Workflow

When modifying catalog data:

1. Edit the individual catalog file (e.g., `CarsCatalog.json`)
2. Synchronize changes into `gameDataCatalogs.v3.normalized.json`:
   ```python
   # Example: Sync CarsCatalog
   import json
   
   with open('seeds/Atul-Final-Seeds/CarsCatalog.json', 'r') as f:
       source = json.load(f)
   
   with open('seeds/Atul-Final-Seeds/gameDataCatalogs.v3.normalized.json', 'r') as f:
       bundle = json.load(f)
   
   for entry in bundle:
       if entry['path'] == '/GameData/v1/catalogs/CarsCatalog':
           entry['data'] = source
           break
   
   with open('seeds/Atul-Final-Seeds/gameDataCatalogs.v3.normalized.json', 'w') as f:
       json.dump(bundle, f, indent=2)
   ```
3. Run `npm run tools:seed-firestore` to deploy

## Legacy Seed Artifacts